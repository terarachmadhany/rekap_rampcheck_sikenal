SELECT
    rc.id, 
    rc.date as date, 
    rc.time as time, 
    upt.name as upt_name,
    rc.location_type, 
    vehicle.number as plat_number,
    route.name as route_name,
    rc.driver_name,
    rc.driver_age, 
    rc.vehicle_type, 
    rc.summary, 
    rc.stuk_number,
    terminal.name as terminal_name,
    vehicle_type.name as vehicle_type_name, 
    vendor.name as vendor_name,
    rc.value->>'status_kartu_uji' as status_kartu_uji,
    rc.value->>'status_kp_regular' as status_kp_regular,
    rc.value->>'status_kp_cadangan' as status_kp_cadangan,
    rc.value->>'status_driver_sim' as status_driver_sim,
    rc.value->>'lampu_utama_dekat' as lampu_utama_dekat,
    rc.value->>'lampu_dekat_kanan' as lampu_dekat_kanan,
    rc.value->>'lampu_dekat_kiri' as lampu_dekat_kiri,
    rc.value->>'lampu_utama_jauh' as lampu_utama_jauh,
    rc.value->>'lampu_jauh_kanan' as lampu_jauh_kanan,
    rc.value->>'lampu_jauh_kiri' as lampu_jauh_kiri,
    rc.value->>'lampu_sein_depan' as lampu_sein_depan,
    rc.value->>'sein_depan_kanan' as sein_depan_kanan,
    rc.value->>'sein_depan_kiri' as sein_depan_kiri,
    rc.value->>'lampu_sein_belakang' as lampu_sein_belakang,
    rc.value->>'sein_belakang_kanan' as sein_belakang_kanan,
    rc.value->>'sein_belakang_kiri' as sein_belakang_kiri,
    rc.value->>'lampu_rem' as lampu_rem,
    rc.value->>'lampu_rem_kanan' as lampu_rem_kanan,
    rc.value->>'lampu_rem_kiri' as lampu_rem_kiri,
    rc.value->>'lampu_mundur' as lampu_mundur,
    rc.value->>'lampu_mundur_kanan' as lampu_mundur_kanan,
    rc.value->>'lampu_mundur_kiri' as lampu_mundur_kiri,
    rc.value->>'rem_utama' as rem_utama,
    rc.value->>'rem_parkir' as rem_parkir,
    rc.value->>'kaca_depan' as kaca_depan,
    rc.value->>'ban_depan' as ban_depan,
    rc.value->>'ban_depan_kanan' as ban_depan_kanan,
    rc.value->>'ban_depan_kiri' as ban_depan_kiri,
    rc.value->>'ban_belakang' as ban_belakang,
    rc.value->>'ban_belakang_kanan' as ban_belakang_kanan,
    rc.value->>'ban_belakang_kiri' as ban_belakang_kiri,
    rc.value->>'sabuk_pengaman' as sabuk_pengaman,
    rc.value->>'status_spedometer' as status_spedometer,
    rc.value->>'lampu_posisi_depan' as lampu_posisi_depan,
    rc.value->>'lampu_posisi_depan_kanan' as lampu_posisi_depan_kanan,
    rc.value->>'lampu_posisi_depan_kiri' as lampu_posisi_depan_kiri,
    rc.value->>'lampu_posisi_belakang' as lampu_posisi_belakang,
    rc.value->>'lampu_posisi_belakang_kanan' as lampu_posisi_belakang_kanan,
    rc.value->>'lampu_posisi_belakang_kiri' as lampu_posisi_belakang_kiri,
    rc.value->>'status_spion' as status_spion,
    rc.value->>'status_wiper' as status_wiper,
    rc.value->>'status_klakson' as status_klakson,
    rc.value->>'seat' as seat,
    rc.value->>'status_ban_cadangan' as status_ban_cadangan,
    rc.value->>'segitiga_pengaman' as segitiga_pengaman,
    rc.value->>'dongkrak' as dongkrak,
    rc.value->>'pembuka_roda' as pembuka_roda,
    rc.value->>'status_senter' as status_senter,
    rc.value->>'pintu_darurat' as pintu_darurat,
    rc.value->>'jendela_darurat' as jendela_darurat,
    rc.value->>'pemecah_kaca' as pemecah_kaca,
    rc.value->>'kondisi_driver' as kondisi_driver,
    rc.value->>'opsi_laik' as opsi_laik,
    rc.value->>'opsi_tidak_laik' as opsi_tidak_laik,
    CASE
        WHEN rc.value->>'summary' = 'true' THEN 'LAIK JALAN'
        WHEN rc.value->>'summary' = 'false' THEN 'TIDAK LAIK'
    END AS summary_value
FROM transportation.ramp_check rc
LEFT JOIN transportation.vehicle vehicle ON rc.tvehicle_id = vehicle.id
LEFT JOIN transportation.route route ON rc.troute_id = route.id
LEFT JOIN public.terminal terminal ON rc.pterminal_id = terminal.id
LEFT JOIN transportation.vehicle_type vehicle_type ON rc.tvehicle_type_id = vehicle_type.id
LEFT JOIN public.upt upt ON rc.pupt_id = upt.id
LEFT JOIN transportation.vendor vendor ON rc.tvendor_id = vendor.id
WHERE date_trunc('year', rc.date) = date_trunc('year', now())
ORDER BY rc.date ASC;
